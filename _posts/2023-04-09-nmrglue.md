---
layout: post
title: nmrglue
tags: [nmr, ucsf, csv, python, matplotlib]
---

[nmrglue](https://github.com/jjhelmus/nmrglue) is a python module to work with nmr data. It supports multiple nmr formats including bruker, varian, sparky, etc. The complete list is in the [document](https://nmrglue.readthedocs.io/en/latest/tutorial.html).

In this post, I will show how to use nmrglue to process and visualize 2D ucsf(sparky) NMR data. <!--break-->


# How to use nmrglue

## Installation
The nmrglue can be easily installed with pip:

```
pip install nmrglue
```

## Read Sparky data
Now we can import and use nmrglue:

{% highlight python %}

import nmrglue as ng

hsqc_dic, hsqc_data = ng.sparky.read('/path/to/data/c13hsqc.ucsf')
{% endhighlight %}

## Show headers
The headers are now loaded into a dictionary:

{% highlight python %}
for k, v in hsqc_dic.items():
  print(k, v)
{% endhighlight %}

Outputs:


```
ident UCSF NMR
naxis 2
ncomponents 1
encoding 0
version 2
owner asurin
date Mon Apr 03 11:32:34 2023
comment 
seek_pos 4194740
scratch 
w1 {'nucleus': '13C', 'spectral_shift': 0, 'npoints': 1024, 'size': 1024, 'bsize': 128, 'spectrometer_freq': 125.77224731445312, 'spectral_width': 20752.421875, 'xmtr_freq': 75.00618743896484, 'zero_order': 0.0, 'first_order': 0.0, 'first_pt_scale': 0.0, 'extended': b'\x80\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00'}
w2 {'nucleus': '1H', 'spectral_shift': 0, 'npoints': 1024, 'size': 1024, 'bsize': 128, 'spectrometer_freq': 500.1524963378906, 'spectral_width': 7142.85693359375, 'xmtr_freq': 5.000030517578125, 'zero_order': 0.0, 'first_order': 0.0, 'first_pt_scale': 0.0, 'extended': b'\x80\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00'}
```
I have loaded a hsqc 2D spectrum and w1 and w2 are axis headers for carbon 13 and proton. 

# Visualization

{% highlight python %}

hsqc_data = hsqc_data[::-1]
plt.figure(figsize=(10,10))
plt.imshow(hsqc_data, cmap='seismic', vmin=-1e8, vmax=1e8)
plt.colorbar()

{% endhighlight %}

![hsqc](/images/nmr/hsqc_nmrglue.png)